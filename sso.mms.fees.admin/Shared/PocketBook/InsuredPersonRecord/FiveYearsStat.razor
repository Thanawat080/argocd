<div class="site-layout-background" style="padding: 24px;">
    <div class="mms-nav-title">
        <div class="mms-text-title px-4 py-3">สมุดพกสขภาพของผู้ประกันตน</div>
    </div>

    <div class="container py-4">
        <div class="mms-txt-header py-2">ข้อมูลผู้ประกันตน / สิทธิการรักษา / สถิติย้อนหลัง </div>
        <hr />
        <Table DefaultExpandAllRows DataSource="@data" OnChange="OnChange" TItem="MockUpData" @bind-PageSize="pageSize" Bordered>
            <ColumnDefinitions>
                <PropertyColumn Title="รายการตรวจสุขภาพ" Property="(MockUpData c)=>c!.HeathCheckList" Width="20px" Align="ColumnAlign.Center" />
                <PropertyColumn Title="ปี 62" Property="(MockUpData c)=>c!.Year62" Width="100px" />
                <PropertyColumn Title="ปี 63" Property="(MockUpData c)=>c!.Year63" Width="100px" />
                <PropertyColumn Title="ปี 64" Property="(MockUpData c)=>c!.Year64" Width="100px" />
                <PropertyColumn Title="ปี 65" Property="(MockUpData c)=>c!.Year65" Width="100px" />
                <PropertyColumn Title="ปี 66" Property="(MockUpData c)=>c!.Year66" Width="100px" />
                <PropertyColumn Title="" Property="(MockUpData c)=>c!.NoContent" Width="100px">
                    @if (context.NoContent == "detail")
                    {
                        <div class="d-flex align-items-center justify-content-center">
                            <img class="mx-2" src="helper_shared/PortalAdminImage/eye.png"
                            style="width:24px;height:24px; cursor:pointer;" @onclick=@(()=>OpenStatModal(true)) />
                        </div>
                    }
                    else if (context.NoContent == "graph")
                    {
                        <div class="d-flex align-items-center justify-content-center">
                            <img class="mx-2" src="helper_shared/PortalAdminImage/eye.png"
                             style="width:24px;height:24px; cursor:pointer;" @onclick=@(()=>OpenGraphModal(true)) />
                    </div>
                    }
                </PropertyColumn>
            </ColumnDefinitions>

            <PaginationTemplate>
                <Pagination Class="pt-2" Total="context.Total"
                            PageSize="context.PageSize"
                            Current="context.PageIndex"
                                        ShowSizeChanger
                             OnChange="context.HandlePageChange" />
             </PaginationTemplate>

             <HeaderTemplate>
                 <TableRow>
                     <SimpleTableHeader RowSpan="2">รายการตรวจสุขุภาพ</SimpleTableHeader>
                     <SimpleTableHeader ColSpan="5">ประวัติผลการตรวจ</SimpleTableHeader>
                     <SimpleTableHeader RowSpan="2"></SimpleTableHeader>
                 </TableRow>
                 <TableRow>
                     <SimpleTableHeader>ปี62</SimpleTableHeader>
                     <SimpleTableHeader>ปี63</SimpleTableHeader>
                     <SimpleTableHeader>ปี64</SimpleTableHeader>
                     <SimpleTableHeader>ปี65</SimpleTableHeader>
                     <SimpleTableHeader>ปี66</SimpleTableHeader>
                 </TableRow>
             </HeaderTemplate>
         </Table>

     </div>
 </div>
 <Stat _visible=@openStatModal OnClose="@OpenStatModal"></Stat>

 <Graph _visible=@openGraphModal OnClose="@OpenGraphModal"></Graph>

 @using System.ComponentModel.DataAnnotations;
 @using System.Text.Json;
 @using System.ComponentModel;
 @using sso.mms.fees.admin.Shared.PocketBook.Modals
 @using sso.mms.fees.admin.Shared.PocketBook.ViewModal;





 @code {

    [Parameter]
    public EventCallback<int> usePage { get; set; }


    int pageSize = 5;

    Table<MockUpData> Table;

    string txtValue { get; set; }

    public async Task goEdit(int item)
    {
        await usePage.InvokeAsync(item);
    }

    bool openStatModal { get; set; }
    bool openGraphModal { get; set; }


    class MockUpData
    {
        public MockUpData(
        string heathCheckList,
        string year62,
        string year63,
        string year64,
        string year65,
        string year66,
        string noContent
        )
        {
            HeathCheckList = heathCheckList;
            Year62 = year62;
            Year63 = year63;
            Year64 = year64;
            Year65 = year65;
            Year66 = year66;
            NoContent = noContent;
        }
        public string HeathCheckList { get; set; }
        public string Year62 { get; set; }
        public string Year63 { get; set; }
        public string Year64 { get; set; }
        public string Year65 { get; set; }
        public string Year66 { get; set; }
        public string NoContent { get; set; }
    }

    MockUpData[] data =
    {
           new("การได้ยิน","ปกติ","ผิดปกติ","ผิดปกติ","ผิดปกติ","ผิดปกติ","detail"),
           new("ตรวจเต้านม","ผิดปกติ","ผิดปกติ","ผิดปกติ","ผิดปกติ","ผิดปกติ","detail"),
           new("ตรวจตา","ปกติ","ปกติ","ปกติ","ปกติ","ผิดปกติ","detail"),
           new("ตรวจตา Snelle Eye Chart","ปกติ","ปกติ","ปกติ","ปกติ","ปกติ","detail"),
           new("ความสมบูรณ์ของเม็ดเลือด","ปกติ","-","-","-","-","detail"),
           new("Chest X-ray","-","-","-","ปกติ","-","detail"),
           new("การตรวจระดับน้ำตาลในเลือด","86","-","-","-","86","graph"),
           new("การทำงานของไต","0.50","0.89","1.20","1.00","0.99","graph"),
           new("การตรวจไขมันในเลือด Choresterol","100","100","100","100","220","graph"),
           new("การตรวจไขมันในเลือด HDL","80","80","80","100","220","graph"),
           new("ตรวจเชื้อไวรัสตับอักเสบ","ปกติ","ปกติ","ปกติ","ปกติ","ผิดปกติ","detail"),
           new("ตรวจมะเร็งปากมดลูก PVP","ปกติ","-","-","-","ปกติ","detail"),
           new("ตรวจมะเร็งปากมดลูก VIA","ปกติ","-","-","-","-","detail"),
           new("การตรวจปัสสาวะ UA","ปกติ","ปกติ","ปกติ","ปกติ","ปกติ","detail"),
           new("การตรวจหาเลือดในอุจจาระ","ปกติ","ปกติ","ปกติ","ปกติ","ปกติ","detail"),
    };

    void OnChange(QueryModel<MockUpData> query)
    {
        Console.WriteLine(JsonSerializer.Serialize(query));
    }

    public void OpenStatModal(bool value)
    {
        openStatModal = value;
    }

    public void OpenGraphModal(bool value)
    {
        openGraphModal = value;
    }
}