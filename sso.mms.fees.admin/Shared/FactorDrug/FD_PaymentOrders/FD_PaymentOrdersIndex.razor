﻿<div class="site-layout-background" style="padding: 24px;">
    <div class="mms-nav-title">
        <div class="mms-text-title px-4 py-3">ฮีโมฟีเลีย (Hemophilia)</div>
    </div>
    <div class="container py-4">
        <div class="mms-txt-header py-2">รายการใบคำสั่งจ่าย</div>
        <hr />
        <div class="d-flex justify-content-between">
            <Button Type="@ButtonType.Primary"  @onclick="(() => {})">
                <i class="fa-solid fa-file-arrow-down"></i> &nbsp; อนุมัติคำสั่งจ่าย
            </Button>

            <Space Direction="@DirectionVHType.Horizontal" Class="d-flex justify-content-end">
                <SpaceItem>
                    <Search Placeholder="ข้อมูลที่ต้องการค้นหา" EnterButton="true" AllowClear />
                </SpaceItem>
            </Space>

        </div>
        <hr />
        <div class="mt-3">
            <Table DataSource="data" OnChange="OnChange" TItem="Data" HidePagination Bordered>
                <Column Title="ลำดับ" DataIndex="No" TData="int" Align="ColumnAlign.Center" Width="100px" />
                <Column Title="งวดการจ่าย" DataIndex="Paymentperiod" TData="string" Align="ColumnAlign.Center" Width="200px" />
                <Column Title="เลขชุดคำสั่งจ่าย" DataIndex="PaymentOrderNo" TData="string" Align="ColumnAlign.Center" Width="70px"/>
                <Column Title="ยอดการเงินรวม(บาท)" DataIndex="TotalFinancialAmount" TData="string" Align="ColumnAlign.Center" Width="70px"/>
                <Column Title="สถานะ" DataIndex="Status" TData="string" Align="ColumnAlign.Center" Width="70px"/>
                <Column Title="เลขชุดคำสั่งจ่าย" DataIndex="NoContent" TData="string" Align="ColumnAlign.Center" Width="70px">
                    @if (context.Status == "รออนุมัติ")
                    {
                        <span style="color:#F56C6C">รออนุมัติ</span>
                    }
                    else
                    {
                        <span style="color:#59AD46">อนุมัติแล้ว</span>
                    }
                </Column>
                <Column Title="" DataIndex="NoContent" TData="string" Align="ColumnAlign.Center" Width="70px">
                    @if (context.Paymentperiod == "2566/3")
                    {
                        <img class="mx-2" src="helper_shared/PortalAdminImage/edit.png" style="width:24px;height:24px;" @onclick=@(() => GoToInstallmentListPage(2,context.Paymentperiod)) />
                    }
                    else
                    {
                        <img class="mx-2" src="helper_shared/PortalAdminImage/eye.png" style="width:24px;height:24px;" @onclick=@(() => ViewDetail(2)) />
                    }
                </Column>
            </Table>
            <Pagination Class="py-3"
                        ShowSizeChanger
                        OnShowSizeChange="OnShowSizeChange"
                        DefaultCurrent="3"
                        Total="500" />
        </div>
    </div>
</div>

@code {
    [Parameter]
    public EventCallback<(int, string)> IndexPage { get; set; }

    public async Task GoToInstallmentListPage(int page, string installment)
    {
        await IndexPage.InvokeAsync((page, installment));
    }


    public record Data(int No, string Paymentperiod, string PaymentOrderNo, string TotalFinancialAmount,string Status,string NoContent);

    public Data[] data =
    {
        new(1,"2566/3","STM0001","1,000,000.00","รออนุมัติ",""),
        new(2,"2566/2","STM0002","2,000,000.00","อนุมัติแล้ว",""),
        new(3,"2566/1","STM0003","1,700,000.00","อนุมัติแล้ว",""),
    };

    void OnChange(QueryModel<Data> query)
    {
        Console.WriteLine(JsonSerializer.Serialize(query));
    }

    private void OnShowSizeChange(PaginationEventArgs args)
    {
        var (current, pageSize) = args;
        Console.WriteLine($"{current}, {pageSize}");
    }

    private void ViewDetail(int open)
    {
    }

}