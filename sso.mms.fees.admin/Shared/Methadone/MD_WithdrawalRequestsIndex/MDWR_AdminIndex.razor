<div class="site-layout-background" style="padding: 24px;">
    <div class="mms-nav-title">
        <div class="mms-text-title px-4 py-3">ค่าบริการทางการแพทย์เมทาโดน</div>
    </div>
    <div class="container py-4">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item" aria-current="page">
                    <span class="breadcum-process py-2">รายการขอเบิก</span>
                </li>
            </ol>
        </nav>
        <hr />
        <div class="row py-4">
            <div class="col-sm-12 col-md-6"></div>
            <div class="col-sm-12 col-md-6">
                <div class="row">
                    <div class="col-5 d-flex align-items-center justify-content-end">
                        <Button Type="@ButtonType.Primary">
                            <i class="fa-solid fa-file-arrow-down"></i>
                            อนุมัติรายการจ่าย
                        </Button>
                    </div>
                    <div class="col-7">
                        <Space Direction="@DirectionVHType.Vertical" Class="mms-btn-serch w-100">
                            <SpaceItem>
                                <Search Placeholder="ข้อมูลที่ต้องการค้นหา" EnterButton="true" />
                            </SpaceItem>
                        </Space>
                    </div>
                </div>
            </div>
        </div>
        <Table DefaultExpandAllRows DataSource="data" Bordered ScrollX="1000">
            <PropertyColumn Property="c=>c.Id" Title="ลำดับ" Align="ColumnAlign.Center" Width="7%" />
            <PropertyColumn Property="c=>c.year" Title="งวดการจ่าย" Align="ColumnAlign.Center" />
            <PropertyColumn Property="c=>c.Amount" Title="ยอดการเงินรวม(บาท)" Align="ColumnAlign.Center">
                @String.Format("{0:n}", context.Amount)
            </PropertyColumn>
            <PropertyColumn Property="c=>c.year" Title="" Align="ColumnAlign.Center" Width="7%">
                <img class="mx-2" title="ดู" src="helper_shared/PortalAdminImage/eye.png" style="width:24px;height:24px; cursor:pointer;" @onclick="() => Indexpage(2,context.year)" />
            </PropertyColumn>
            </Table>
        </div>
    </div>

    @if (isloading == true)
{
    <style>
        body {
            overflow: hidden;
        }
    </style>

    <LoadingPage></LoadingPage>
}

@code {
    [Parameter]
    public EventCallback<(int ,string)> IndexPage { get; set; }

    IEnumerable<Data> selectedRows;
    int page;
    bool openConfirmModal { get; set; }
    bool openViewDataModal { get; set; }
    string Placeholder = "วว/ดด/ปปปป";
    bool _visible = false;
    bool isloading = false;

    List<Data> _data;

    public class Data
    {
        public bool HosStatus { get; set; }
        public string Id { get; set; }
        public string Key { get; set; }
        public string year { get; set; }
        public string Name { get; set; }
        public string PayNo { get; set; }
        public int Amount { get; set; }
        public string Status { get; set; }

    }

    List<Data> data = new List<Data>();

    string _selectedValue;


    protected override async Task OnInitializedAsync()
    {
        isloading = true;
        data = new List<Data>
    {
        new Data {
            HosStatus  = true,
            Id = "1",
            Key = "1",
            year = "2566/3",
            PayNo ="STM0001",
            Amount =34000,
            Status ="1" //1 รออนุมัติ 2 อนุมัติแล้ว
        },
        new Data {
            HosStatus  = true,
            Id = "2",
            Key = "2",
            year = "2565/2",
             PayNo ="STM0002",
            Amount =20000,
            Status ="2"
        },
    };
        isloading = false;
        StateHasChanged();
    }
    public async Task Indexpage(int usepage,string year)
    {
        await IndexPage.InvokeAsync((usepage ,year));
    }
}
