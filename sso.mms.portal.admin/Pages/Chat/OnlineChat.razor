@using sso.mms.chat.Models.ChatUserDetailList
@using sso.mms.chat.ViewModels;
@using sso.mms.helper.PortalModel;
@using sso.mms.portal.admin.ViewModels;
<style>
        :root {
        --mdc-theme-primary: #334396;
    }

    .form-control, .form-select {
        display: block;
        width: 100%;
        padding: 0.375rem 0.75rem;
        font-size: 1rem;
        font-weight: 400;
        line-height: 1.5;
        color: var(--bs-body-color);
        background-color: var(--bs-body-bg);
        background-clip: padding-box;
        border: var(--bs-border-width) solid #9e9e9e;
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        border-radius: var(--bs-border-radius-sm);
        transition: border-color .15s ease-in-out,box-shadow .15s ease-in-out;
        height: 3rem;
    }

    .card-title {
        background: #FFCC41;
        box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.1);
        border-radius: 10px 10px 0px 0px;
        margin-bottom: 0px;
        height: 74px;
    }

    .card-chat {
        background: #FFFFFF;
        border-radius: 0px 0px 8px 8px;
        height: 749px;
    }

    .txt-title {
        font-family: 'Noto Sans Thai';
        font-style: normal;
        font-size: 32px;
        font-weight: 600;
        line-height: 150%;
        color: #334396;
    }

    .serch-bg {
        background: #334396;
        /* Inside auto layout */
        flex: none;
        order: 1;
        align-self: stretch;
        flex-grow: 0;
        width: 48px;
        height: 48px;
    }

    .list-group-item:first-child {
        border-top-left-radius: 0px;
        border-top-right-radius: 0px;
        border: 0px;
    }

    .list-group-item + .list-group-item {
        border-top-width: 0;
        border: 0px;
    }

    .scrollbar-admin {
        /* margin-left: 30px; */
        float: left;
        height: 630px;
        width: 100%;
        background: #fff;
        overflow-y: scroll;
        margin-bottom: 25px;
    }

    .force-overflow {
        min-height: 0px;
    }

    .scrollbar-primary::-webkit-scrollbar {
        width: 12px;
        background-color: #F5F5F5;
    }



    .scrollbar-primary::-webkit-scrollbar-thumb {
        border-radius: 10px;
        -webkit-box-shadow: inset 0 0 6px rgb(255 255 255 / 0%);
        background-color: #ffffff;
    }

    .scrollbar-primary::-webkit-scrollbar-track {
        -webkit-box-shadow: inset 0 0 0px rgb(0 0 0 / 0%);
        background-color: #ffffff;
        border-radius: 10px;
    }
</style>

<div class="text-center card-title p-2">
    <span class="txt-title">Online Chat</span>
</div>
<div class="card-chat">
    <div class="card-body">
        <div class="input-group p-4">
            <input type="text" class="form-control" placeholder="ค้นหาแชท" aria-label="" aria-describedby="basic-addon2" @bind="@searchList">
            <div class="input-group-append">
                <button class="serch-bg btn btn-primary" type="button" @onclick="@(()=> SearchChatRoom(searchList))">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M10 2C5.58172 2 2 5.58172 2 10C2 14.4183 5.58172 18 10 18C11.8487 18 13.551 17.3729 14.9056 16.3199L20.2929 21.7071L20.3871 21.7903C20.7794 22.0953 21.3466 22.0676 21.7071 21.7071C22.0976 21.3166 22.0976 20.6834 21.7071 20.2929L16.3199 14.9056C17.3729 13.551 18 11.8487 18 10C18 5.58172 14.4183 2 10 2ZM10 4C13.3137 4 16 6.68629 16 10C16 13.3137 13.3137 16 10 16C6.68629 16 4 13.3137 4 10C4 6.68629 6.68629 4 10 4Z" fill="white" />
                    </svg>
                </button>
            </div>
        </div>
        <div class="scrollbar-admin scrollbar-primary">
            <div class="force-overflow"></div>
            <ul class="list-unstyled mb-0">
                <li>
                    <HospitalChatList ChatRoomMList="ChatRoomMList"
                                      searchChatRoomMList="searchChatRoomMList"
                                      OnGetHospitalData="@GetHospitalData"
                                      OnGetChatRoomMTitle="@GetChatRoomTitle" />
                </li>
            </ul>
        </div>
    </div>
</div>



@code {

    [Parameter]
    public List<ChatRoomMListModel> ChatRoomMList { get; set; }

    [Parameter]
    public List<ChatRoomMListModel> searchChatRoomMList { get; set; }

    [Parameter]
    public EventCallback<List<HospitalMListModel>> OnGetHospitalData { get; set; }

    [Parameter]
    public EventCallback<string> OnSearchChatMList { get; set; }

    [Parameter]
    public EventCallback<string> OnGetChatRoomMTitle { get; set; }

    public string? searchList = "";

    private async Task GetHospitalData(List<HospitalMListModel> item)
    {
        await OnGetHospitalData.InvokeAsync(item);
        StateHasChanged();
    }

    private async Task GetChatRoomTitle(string Title)
    {
        await OnGetChatRoomMTitle.InvokeAsync(Title);
        StateHasChanged();
    }

    public async Task SearchChatRoom(string item)
    {
        await OnSearchChatMList.InvokeAsync(item);
    }


}
